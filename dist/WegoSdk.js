!function(e,r){"object"==typeof exports&&"object"==typeof module?module.exports=r():"function"==typeof define&&define.amd?define([],r):"object"==typeof exports?exports.WegoSdk=r():e.WegoSdk=r()}(self,(function(){return e={22:e=>{var r={__host:{staging:{v3:"https://srv.wegostaging.com/v3",v2:"https://srv.wegostaging.com/v2",v1:"https://srv.wegostaging.com"},production:{v3:"https://srv.wego.com/v3",v2:"https://srv.wego.com/v2",v1:"https://srv.wego.com"}},_hotelEndpoints:{hotelDetailsUrl:function(e){return r.getHost("v1")+"/hotels/hotels/"+e}},getHost:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"v2";return this.__host[this.getEnvironment()][e]},setEnvironment:function(e){this.env=e},getEnvironment:function(){return this.env||Wego.ENV||"staging"},searchTrips:function(e,r,t,n){return this.post(r,e,t,n)},fetchTrips:function(e,r,t,n){var i="".concat(e,"/").concat(r,"/results");return this.get(i,t||{},n)},searchHotels:function(e,r,t,n){return this.post(r,e,t,n)},fetchHotels:function(e,r,t,n){var i="".concat(e,"/").concat(r,"/results");return this.get(i,t||{},n)},searchHotel:function(e,r,t,n){var i="".concat(e,"/").concat(r.search.hotelId,"/searches");return this.post(r,i,t,n)},fetchHotelRates:function(e,r){var t=this.__host[this.getEnvironment()].v3+"/metasearch/hotels/"+e+"/rates";return this.get(t,r)},fetchHotelDetails:function(e,r){var t=this._hotelEndpoints.hotelDetailsUrl(e);return this.get(t,r)},fetchCities:function(e){var r=this.__host[this.getEnvironment()].v1+"/places/cities";return this.get(r,e)},fetchAirports:function(e){var r=this.__host[this.getEnvironment()].v1+"/places/airports";return this.get(r,e)},post:function(e,r,t,n){return fetch(this.buildUrl(r,t),{method:"POST",credentials:"include",mode:"cors",headers:Object.assign({},n,{"Content-Type":"application/json"}),body:JSON.stringify(e)}).then((function(e){return e.ok?e.json():Promise.reject()})).catch((function(e){return Promise.reject(e)}))},get:function(e,r,t){return fetch(this.buildUrl(e,r),{method:"GET",credentials:"include",mode:"cors",headers:Object.assign({},t,{"Content-Type":"application/json"})}).then((function(e){return e.ok?e.json():Promise.reject()})).catch((function(e){return Promise.reject(e)}))},buildUrl:function(e,r){if(r){var t=[];for(var n in r){var i=r[n];i instanceof Array?i.forEach((function(e){t.push(n+"[]="+e)})):t.push(n+"="+r[n])}e+="?"+t.join("&")}return e}};e.exports=r},15:e=>{var r=function(e){e=e||{},this.initCallApi=e.initCallApi,this.callApi=e.callApi,this.delays=e.delays,this.onSuccessResponse=e.onSuccessResponse,this.pollLimit=e.pollLimit};r.prototype={start:function(){var e=this;this.timer=setTimeout((function(){e.pollCount++,e.retryCount=0,e.fetch(e.initCallApi||e.callApi)}),0)},reset:function(){clearTimeout(this.timer),this.abortLastFetch&&this.abortLastFetch(),this.pollCount=0,this.forceStop=!1},stop:function(){this.forceStop=!0},isStopping:function(){return this.forceStop},isLastPolling:function(){return this.pollCount===this.pollLimit},getProgress:function(){return this.pollCount===this.pollLimit?100:this.pollCount/this.pollLimit*100},handleSuccessResponse:function(e){this.onSuccessResponse(e),this.preparePoll()},preparePoll:function(){var e=this;this.pollCount<this.delays.length&&!this.forceStop&&(this.timer=setTimeout((function(){e.poll()}),this.delays[this.pollCount]))},poll:function(){this.pollCount++,this.retryCount=0,this.fetch(this.callApi)},retry:function(e){this.retryCount<3&&(this.retryCount++,this.fetch(e))},fetch:function(e){var r=this,t=!1;this.abortLastFetch=function(){t=!0},e().then((function(e){t||r.handleSuccessResponse(e)})).catch((function(){r.retry(e)}))}},e.exports=r},469:(e,r,t)=>{function n(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var i=t(854),o=t(355),a=t(915),s=t(22),c=t(15),u=function(){function e(r,t){!function(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}(this,e);var n=this;t=t||{},n.currency=t.currency||{},n.locale=t.locale,n.showWegoFares=t.showWegoFares||!1,n.siteCode=t.siteCode,n.deviceType=t.deviceType||"DESKTOP",n.appType=t.appType||"WEB_APP",n.userLoggedIn=t.userLoggedIn,n.paymentMethodIds=t.paymentMethodIds||[],n.providerTypes=t.providerTypes||[],n.onProgressChanged=t.onProgressChanged||function(){},n.onSponsorsChanged=t.onSponsorsChanged||function(){},n.onTripsChanged=t.onTripsChanged||function(){},n.onTotalTripsChanged=t.onTotalTripsChanged||function(){},n.onCheapestTripChanged=t.onCheapestTripChanged||function(){},n.onFastestTripChanged=t.onFastestTripChanged||function(){},n.onBestExperienceTripChanged=t.onBestExperienceTripChanged||function(){},n.onDisplayedFilterChanged=t.onDisplayedFilterChanged||function(){},n.onProvidersChanged=t.onProvidersChanged||function(){},n.onSearchCreated=t.onSearchCreated||function(){},n.requestHeaders=t.requestHeaders,n.merger=new i,n.poller=new c({initCallApi:function(){return s.searchTrips(r,n.getSearchRequestBody(),{currencyCode:n.currency.code,locale:n.locale},n.requestHeaders)},callApi:function(){return s.fetchTrips(r,n.responseSearch.id,n.fetchTripsParams(),n.requestHeaders)},onSuccessResponse:function(e){return n.handleSearchResponse(e)}}),n.reset()}var r,t;return r=e,(t=[{key:"searchTrips",value:function(e){var r=this;r.search=e,r.reset();var t,n,i=e.legs,o=i.length>2;if(2===i.length){var a=["departureCityCode","departureAirportCode","arrivalCityCode","arrivalAirportCode"];(t=i[0])===(n=i[1])||t[a[0]]===n[a[2]]&&t[a[1]]===n[a[3]]&&t[a[2]]===n[a[0]]&&t[a[3]]===n[a[1]]||(o=!0)}r.multiCity=o,r.merger.multiCity=o;var s=r.poller;s.delays=(o?[0,3,3,3,4,4,4,4,5,5,5,5,5,6]:[0,1,3,4,5,6,6,6]).map((function(e){return 1e3*e})),s.pollLimit=s.delays.length-1,r.updateResult(),s.start()}},{key:"handleSearchResponse",value:function(e){var r=this;r.mergeResponse(e),r.updateResult(),1===r.poller.pollCount&&r.onSearchCreated(e.search)}},{key:"mergeResponse",value:function(e){var r=this;r.merger.mergeResponse(e),r.processedFaresCount=e.count,r.responseSearch=e.search}},{key:"reset",value:function(){var e=this;e.poller.reset(),e.merger.reset(),e.responseSearch={},e.processedFaresCount=0}},{key:"updatePaymentMethodIds",value:function(e){var r=this;r.paymentMethodIds=e,r.reset(),r.updateResult(),r.poller.start()}},{key:"updateProviderTypes",value:function(e){var r=this;r.providerTypes=e,r.reset(),r.updateResult(),r.poller.start()}},{key:"updateSort",value:function(e){this.sort=e,this.updateResult()}},{key:"updateFilter",value:function(e){this.filter=e,this.updateResult()}},{key:"updateCurrency",value:function(e){var r=this;r.currency=e,r.merger.updateCurrency(e),r.updateResult()}},{key:"updateResult",value:function(){var e=this,r=e.merger.getTrips();0!==Object.keys(e.merger.getLegConditions()).length&&a.passLegConditions(e.merger.getLegConditions()),0!==Object.keys(e.merger.getFareConditions()).length&&a.passFareConditions(e.merger.getFareConditions());var t=a.filterTrips(r,e.filter,e.multiCity),n=o.sortTrips(t,e.sort,e.filter);e.onTripsChanged(n),e.onCheapestTripChanged(o.getCheapestTrip(t,e.filter)),e.onFastestTripChanged(o.getFastestTrip(t)),e.onBestExperienceTripChanged(o.getBestExperienceTrip(t)),e.onTotalTripsChanged(r),e.onDisplayedFilterChanged(e.merger.getFilter()),e.onProgressChanged(e.poller.getProgress()),e.onProvidersChanged(e.merger.getProviders());var i=e.merger.getSponsors(),s=a.filterSponsors(i,r,e.filter,e.multiCity);e.onSponsorsChanged(s)}},{key:"getSearchRequestBody",value:function(){var e=this,r=e.search||{},t=r.legs||[];return{search:{id:e.responseSearch.id,cabin:r.cabin,deviceType:e.deviceType,appType:e.appType,userLoggedIn:e.userLoggedIn,adultsCount:r.adultsCount,childrenCount:r.childrenCount,infantsCount:r.infantsCount,siteCode:e.siteCode,currencyCode:e.currency.code,locale:e.locale,showWegoFares:e.showWegoFares,legs:t.map((function(e){return{departureCityCode:e.departureCityCode,departureAirportCode:e.departureAirportCode,arrivalCityCode:e.arrivalCityCode,arrivalAirportCode:e.arrivalAirportCode,outboundDate:e.outboundDate}}))},offset:e.processedFaresCount,paymentMethodIds:e.paymentMethodIds,providerTypes:e.providerTypes}}},{key:"fetchTripsParams",value:function(){var e=this;return{currencyCode:e.currency.code,locale:e.locale,paymentMethodIds:e.paymentMethodIds||[],offset:e.processedFaresCount}}}])&&n(r.prototype,t),e}();e.exports=u},854:(e,r,t)=>{function n(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}var i=t(858),o=t(853),a=function(e){e=e||{},this.currency=e.currency};a.prototype={mergeResponse:function(e){var r=this,t=r._getUpdatedTripIds(e),n=e.legs;r._mergeStaticData(e),r._mergeLegs(n),r._mergeLegConditions(e.legConditionIds),r._mergeTrips(e.trips),r._mergeFilter(e.filters),r._mergeScores(e.scores),r._mergeFares(e.fares),r._mergeSponsors(e.sponsors),r._cloneTrips(t)},reset:function(){this.__staticData=this._getEmptyStaticData(),this.__legMap={},this.__tripMap={},this.__trips=[],this.__filter=this._getEmptyFilter(),this.__filterOptionsMap=this._getEmptyFilterOptionsMap(),this.__sponsors=[]},getTrips:function(){return this.__trips},getLegConditions:function(){return this.__staticData.legConditions},getFareConditions:function(){return this.__staticData.fareConditions},getProviders:function(){var e=this.__staticData.providers;return Object.keys(e).map((function(r){return e[r]}))},getFilter:function(){return this.__filter},getSponsors:function(){return this.__sponsors},updateCurrency:function(e){var r=this;r.currency=e;var t=r.__tripMap;for(var n in t)t[n].fares.forEach((function(r){r.price=i.convertPrice(r.price,e),r.paymentFees=i.convertPaymentFees(r.paymentFees,e)}));r._cloneTrips(Object.keys(t)),r.__sponsors=r.__sponsors.map((function(r){return r.fareView.price=i.convertPrice(r.fareView.price,e),r.fareView.paymentFees=i.convertPaymentFees(r.fareView.paymentFees,e),o.cloneObject(r)}));var a=r.__filter;r.__filterOptionTypes.forEach((function(t){var n=r.__filterOptionsMap[t];for(var a in n){var s=n[a];s.price=i.convertPrice(s.price,e),n[a]=o.cloneObject(s)}r._buildFilterOptions(t)})),a.minPrice=i.convertPrice(a.minPrice,e),a.maxPrice=i.convertPrice(a.maxPrice,e),r._cloneFilter()},_mergeStaticData:function(e){var r=this.__staticData;this.__staticDataTypes.forEach((function(t){!function(e,t,n){t&&t.forEach((function(t){var i=t.id||t.code;e[i]=t,"airports"===n?t.city=r.cities[t.cityCode]:"cities"===n&&(t.country=r.countries[t.countryCode])}))}(r[t],e[t],t)}))},_mergeLegs:function(e){if(e){var r=this,t=this.__legMap;e.forEach((function(e){var n=e.id;t[n]||(i.prepareLeg(e,r.__staticData),t[n]=e)}))}},_mergeLegConditions:function(e){if(e){var r=this.__legMap,t=this.__staticData.legConditions;Object.keys(e).forEach((function(n){r[n]&&(r[n].conditions=e[n].map((function(e){return t[e]})),r[n].conditionIds=e[n])}))}},_mergeTrips:function(e){if(e){var r=this,t=this.__tripMap;e.forEach((function(e){var n=e.id;if(!t[n]){var o=e.legIds||[];e.legs=o.map((function(e){return r.__legMap[e]})),i.prepareTrip(e),t[n]=e}}))}},_mergeFares:function(e){if(e){var r=this;e.forEach((function(e){i.prepareFare(e,r.currency,r.__staticData);var t=e.tripId,n=r.__tripMap[t];if(n){for(var o=n.fares,a=0;a<o.length;a++){if(e.id===o[a].id)return;if(e.price.amountUsd<o[a].price.amountUsd)break}o.splice(a,0,e)}}))}},_mergeScores:function(e){if(e){var r=this.__tripMap;for(var t in e){var n=r[t];n&&(n.score=e[t])}}},_mergeSponsors:function(e){var r=this;e&&0!==e.length&&(this.__sponsors=e.reduce((function(e,t){var a,s=o.cloneObject(r.__tripMap[t.fareView.tripId]);return s&&(t.fareView.price=i.convertPrice(t.fareView.price,r.currency),t.fareView.paymentFees=i.convertPaymentFees(t.fareView.paymentFees,r.currency),s.fares=[t.fareView],t.fareView.trip=s,s.legIds&&(t.fareView.legs=s.legIds.map((function(e){return r.__legMap[e]}))),t.fareView.provider=r.__staticData.providers[t.fareView.providerCode]),[].concat(function(e){if(Array.isArray(e))return n(e)}(a=e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(a)||function(e,r){if(e){if("string"==typeof e)return n(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?n(e,r):void 0}}(a)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),[t])}),[]))},_mergeFilter:function(e){if(e){var r=this,t=r.__filter,n=r.multiCity,o=e.legs;o&&(o.forEach((function(e){i.prepareLegFilter(e,r.__staticData)})),t.legs=o),e.minPrice&&(t.minPrice=i.convertPrice(e.minPrice,r.currency)),e.maxPrice&&(t.maxPrice=i.convertPrice(e.maxPrice,r.currency)),e.stopoverDurations&&(t.stopoverDurations=e.stopoverDurations);var a={DIRECT:0,ONE_STOP:1,MORE_THAN_ONE_STOP:2};r.__filterOptionTypes.forEach((function(t){var s=function(e,n){e&&e.forEach((function(e){var o=n>=0;"stops"===t&&(e.code=a[e.code]);var s=(o?n+1+"_":"")+e.code;i.prepareFilterOption(e,t,r.currency,r.__staticData),r.__filterOptionsMap[t][s]=e,e.code=s,o&&(e.legIndex=n)}))};if(n&&o)for(var c=o.length;c--;)s(o[c][t],c);else s(e[t]);r._buildFilterOptions(t)})),r._cloneFilter()}},_getUpdatedTripIds:function(e){var r={},t=this;if(e.scores)for(var n in e.scores)r[n]=!0;return e.fares&&e.fares.forEach((function(e){r[e.tripId]=!0})),Object.keys(r).filter((function(e){return t.__tripMap[e]}))},_cloneTrips:function(e){var r=this.__tripMap;e.forEach((function(e){var t=r[e];t?(t.fares=o.cloneArray(t.fares),r[e]=o.cloneObject(t)):console.error("Trip with "+e+" is missing")})),this.__trips=o.mapValues(r)},_cloneFilter:function(){this.__filter=o.cloneObject(this.__filter)},_buildFilterOptions:function(e){var r=this,t=o.mapValues(r.__filterOptionsMap[e]);t.sort((function(t,n){if("stops"===e){var i=t.code,o=n.code;return r.multiCity&&(i=i.substr(2),o=o.substr(2)),i-o}return t.name<n.name?-1:t.name===n.name?0:1})),r.__filter[e]=t},_getEmptyFilter:function(){var e={legs:[]};return this.__filterOptionTypes.forEach((function(r){e[r]=[]})),e},_getEmptyFilterOptionsMap:function(){var e={};return this.__filterOptionTypes.forEach((function(r){e[r]={}})),e},_getEmptyStaticData:function(){var e={};return this.__staticDataTypes.forEach((function(r){e[r]={}})),e},__staticDataTypes:["countries","cities","airlines","airports","providers","stops","alliances","fareConditions","legConditions"],__filterOptionTypes:["airlines","providers","stops","alliances","originAirports","destinationAirports","stopoverAirports","fareConditions","legConditions"]},e.exports=a},858:e=>{e.exports={prepareTrip:function(e){e.fares=[];var r=e.legs;if(r&&0!==r.length){e.legIdMap={},r.forEach((function(r,t){e.legIdMap[t+r.id]=!0}));var t,n,i=r[0];!function(e,r){var t=0,n=function(e){return Math.min(e,2)};r.forEach((function(e){var r=e.stopoversCount;t=Math.max(t,r),e.stopCode=n(r)})),e.stopCode=n(t)}(e,r),e.airlineCodes=a(r.map((function(e){return e.airlineCodes}))),e.allianceCodes=a(r.map((function(e){return e.allianceCodes}))),e.departureAirportCode=i.departureAirportCode,e.arrivalAirportCode=i.arrivalAirportCode,e.stopoverAirportCodeMap=o(r.map((function(e){return e.stopoverAirportCodes}))),e.changeAirportAtStopover=function(e){for(var r=e.length;r--;)for(var t=e[r].segments,n=t.length-1;n>0;n--)if(t[n].departureAirportCode!==t[n-1].arrivalAirportCode)return!0;return!1}(r),e.stopoverDurationMinutes=(t=r.map((function(e){return e.stopoverDurationMinutes})),n=0,t.forEach((function(e){n=Math.max(n,e)})),n),e.durationMinutes=function(e){return e.reduce((function(e,r){return e+r.durationMinutes}),0)}(r),e.departureTimeMinutes=i.departureTimeMinutes,e.arrivalTimeMinutes=r[r.length-1].arrivalTimeMinutes,e.marketingAirline=function(e){for(var r=null,t=0;t<e.length;t++){var n=e[t].longestSegment.airline;if(null===r)r=n;else if(r.code!=n.code)return null}return r}(r),e.overnight=function(e){var r=!1;return e.forEach((function(e){e.overnight&&(r=!0)})),r}(r),e.longStopover=function(e){var r=!1;return e.forEach((function(e){e.longStopover&&(r=!0)})),r}(r),e.destinationAirportCodes=function(e){var r=[e[0].arrivalAirportCode];if(e.length>1)for(var t=1;t<e.length;t++){var n=e[t].departureAirportCode;r.includes(n)||r.push(e[t].departureAirportCode)}return r}(r),e.originAirportCodes=function(e){var r=[e[0].departureAirportCode];if(e.length>1)for(var t=1;t<e.length;t++){var n=e[t].arrivalAirportCode;r.includes(n)||r.push(e[t].arrivalAirportCode)}return r}(r)}function o(e){var r={};return e.forEach((function(e){(e=e||[]).forEach((function(e){r[e]=!0}))})),r}function a(e){return Object.keys(o(e))}},prepareLeg:function(e,r){var t=this,n=r.airports;e.departureAirport=n[e.departureAirportCode],e.arrivalAirport=n[e.arrivalAirportCode];var i=e.segments||[];i.forEach((function(e){t.prepareSegment(e,r)}));var o=i.map((function(e){return e})).sort((function(e,r){return r.durationMinutes-e.durationMinutes}));e.longestSegment=o[0];var a=o.map((function(e){return e.airline}));e.airlines=a.filter((function(e,r,t){return t.indexOf(e)==r}))},prepareSegment:function(e,r){var t=r.airlines,n=r.airports;e.airline=t[e.airlineCode],e.operatingAirline=t[e.operatingAirlineCode],e.departureAirport=n[e.departureAirportCode],e.arrivalAirport=n[e.arrivalAirportCode]},prepareFare:function(e,r,t){e.provider=t.providers[e.providerCode],e.price=this.convertPrice(e.price,r),e.paymentFees=this.convertPaymentFees(e.paymentFees,r)},prepareFilterOption:function(e,r,t,n){var i=(n[this.__filterOptionTypeToStaticDataType[r]]||{})[e.code]||{};e.name=i.name,e.item=i,e.price=this.convertPrice(e.price,t)},prepareLegFilter:function(e,r){e.departureCity=r.cities[e.departureCityCode],e.departureAirport=r.airports[e.departureAirportCode],e.arrivalCity=r.cities[e.arrivalCityCode],e.arrivalAirport=r.airports[e.arrivalAirportCode]},convertPrice:function(e,r){if(!r)return e;if(!e)return null;var t=e.amount,n=e.totalAmount,i=e.originalAmount,o=0;if(e.paymentFeeAmountUsd&&(o=e.paymentFeeAmountUsd),e.currencyCode!=r.code){var a=r.rate;n=(t=(i=Math.round(e.originalAmountUsd*a))+Math.round(o*a))*Math.round(e.totalAmountUsd/e.amountUsd)}return{currency:r,amount:t,originalAmount:i,totalAmount:n,amountUsd:e.amountUsd,totalAmountUsd:e.totalAmountUsd,originalAmountUsd:e.originalAmountUsd,paymentFeeAmountUsd:o}},convertPaymentFee:function(e,r){if(!r)return e;if(!e)return null;var t=e.amount;if(e.currencyCode!==r.code){var n=r.rate;t=Math.round(e.amountUsd*n)}return{paymentMethodId:e.paymentMethodId,currencyCode:r.code,amount:t,amountUsd:e.amountUsd}},convertPaymentFees:function(e,r){if(!e)return null;var t=this;return e.map((function(e){return t.convertPaymentFee(e,r)}))},__filterOptionTypeToStaticDataType:{airlines:"airlines",stops:"stops",alliances:"alliances",originAirports:"airports",destinationAirports:"airports",stopoverAirports:"airports",providers:"providers",fareConditions:"fareConditions",legConditions:"legConditions"}}},915:(e,r,t)=>{var n=t(853).cloneObject,i=t(853);function o(e,r){return!r||function(e,r){return-1!==r.indexOf("instant")&&e.provider.instant}(e,r)||function(e,r){return-1!==r.indexOf("instant")&&e.provider.wegoFare}(e,r)||function(e,r){return-1!==r.indexOf(e.provider.type)&&!e.provider.instant}(e,r)}function a(e,r){return!r||i.filterByKey(e.provider.code,r)}function s(e,r){if(!r)return!0;for(var t=r.length;t--;){if("NOT_OVERNIGHT"===r[t]&&e.overnight)return!1;if("SHORT_STOPOVER"===r[t]&&e.longStopover)return!1}return!0}function c(e,r,t){if(!r)return!0;for(var n=0;n<r.length;n++){var o=r[n],a=e.legs[o.legIndex];if(!i.filterByRange(a[t],o))return!1}return!0}function u(e,r,t){var n,i;return!function(e){return!!e&&0!==e.length}(r)||e.filter((function(e){n=e.conditionIds;for(var o=0;o<r.length;o++)if(i=l(r[o],t),n&&-1!==n.indexOf(i))return!0;return!1})).length>=1}function l(e,r){if(r)for(var t=Object.keys(r),n=0;n<t.length;n++)if(r[t[n]].code.toLowerCase()===e)return r[t[n]].id}function p(e,r,t,n,l,p,f,d,h,v,y,g,m,C){if(!function(e,r){return!r||e.fares[0]&&i.filterByRange(e.fares[0].price.amountUsd,r)}(e,r.priceRange))return!1;if(C)for(var _=e.legs,T=_.length,A=0;A<T;A++){var I=_[A];if(t&&t[A]&&!t[A][I.stopCode])return!1;var O=function(e,r){var t=e&&Object.keys(e[A]||{}),n=t&&t.length;if(n){for(var i=!1,o=n;!i&&o&&o--;)i=r.indexOf(t[o])>=0;if(!i)return!1}return!0};if(!O(n,I.airlineCodes))return!1;if(!O(l,I.allianceCodes))return!1;if(!O(d,I.stopoverAirportCodes))return!1;if(!s(I,h&&Object.keys(h[A]||{})))return!1;if(!c(e,v,"stopoverDurationMinutes"))return!1}return(C||i.filterByKey(e.stopCode,t))&&c(e,r.departureTimeMinutesRanges,"departureTimeMinutes")&&c(e,r.arrivalTimeMinutesRanges,"arrivalTimeMinutes")&&(C||function(e,r){return!r||!!e.marketingAirline&&i.filterByKey(e.marketingAirline.code,r)}(e,n))&&(C||i.filterByAllKeys(e.allianceCodes,l))&&function(e,r){if(!r)return!0;for(var t=0;t<r.length;t++)if("SAME_AIRLINE"===r[t]&&e.airlineCodes.length>1)return!1;return!0}(e,r.tripOptions)&&i.filterByAllKeys(e.originAirportCodes,p)&&i.filterByAllKeys(e.destinationAirportCodes,f)&&(C||i.filterBySomeKeys(e.stopoverAirportCodeMap,r.stopoverAirportCodes))&&function(e,r){if(!r||0===r.length)return!0;for(var t=0;t<r.length;t++)if("NOT_CHANGE_AIRPORT"===r[t]&&e.changeAirportAtStopover)return!1;return!0}(e,r.stopoverOptions)&&c(e,r.durationMinutesRanges,"durationMinutes")&&(C||i.filterByRange(e.stopoverDurationMinutes,v&&v[0]))&&(C||s(e,r.itineraryOptions))&&i.filterByContainAllKeys(e.legIdMap,r.legIds)&&function(e,r,t){if(!r)return!0;var n=!!t&&t.length>0,i=r.providerCodeMap,s=r.providerTypes;if(!i&&!s)return!0;var c=e.fares;if(c&&c.length>0)for(var u=0;u<c.length;u++){var l=a(c[u],i),p=o(c[u],s),f=!n||t.includes("refundable")&&c[u].refundable;if(l&&p&&f)return!0}return!1}(e,y,r.flexibilities)&&u(e.fares,r.fareTypes,g)&&u(e.legs,r.flightTypes,m)&&(b=e.fares,!(S=r.flexibilities)||0===S.length||!!S.includes("refundable")&&b.some((function(e){return e.refundable})));var b,S}e.exports={passLegConditions:function(e){this.legConditions=e},passFareConditions:function(e){this.fareConditions=e},filterTrips:function(e,r,t){if(!r)return e;var n=this,o=r.stopCodes,a=i.arrayToMaps(o,t),s=i.arrayToMaps(r.airlineCodes,t),c=i.arrayToMaps(r.allianceCodes,t),u=i.arrayToMap(r.originAirportCodes),l=i.arrayToMap(r.destinationAirportCodes),f=t&&i.arrayToMaps(r.stopoverAirportCodes,t),d=t&&i.arrayToMaps(r.itineraryOptions,t),h=r.stopoverDurationMinutesRanges,v={providerCodeMap:i.arrayToMap(r.providerCodes),providerTypes:r.providerTypes};return e.filter((function(e){return p(e,r,a,s,c,u,l,f,d,h,v,n.fareConditions,n.legConditions,t)}))},filterSponsors:function(e,r,t,o){if(!t)return e;var a=this,s=t.stopCodes,c=i.arrayToMaps(s,o),u=i.arrayToMaps(t.airlineCodes,o),l=i.arrayToMaps(t.allianceCodes,o),f=i.arrayToMap(t.originAirportCodes),d=i.arrayToMap(t.destinationAirportCodes),h=o&&i.arrayToMaps(t.stopoverAirportCodes,o),v=o&&i.arrayToMaps(t.itineraryOptions,o),y=t.stopoverDurationMinutesRanges,g={providerCodeMap:i.arrayToMap(t.providerCodes),providerTypes:t.providerTypes};return e.filter((function(e){var i=r.find((function(r){return r.id===e.fareView.tripId}));return i&&((i=n(i)).fares=i.fares.filter((function(r){return r.id===e.fareView.id}))),p(i,t,c,u,l,f,d,h,v,y,g,a.fareConditions,a.legConditions,o)}))}}},355:(e,r,t)=>{function n(e,r){var t="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=function(e,r){if(e){if("string"==typeof e)return i(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?i(e,r):void 0}}(e))||r&&e&&"number"==typeof e.length){t&&(e=t);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,c=!1;return{s:function(){t=t.call(e)},n:function(){var e=t.next();return s=e.done,e},e:function(e){c=!0,a=e},f:function(){try{s||null==t.return||t.return()}finally{if(c)throw a}}}}function i(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}var o=t(853);e.exports={sortTrips:function(e,r){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!r)return e;var i=t.providerTypes,a=t.providerCodes,s=t.flexibilities;function c(e){return e.fares[0]?e.fares[0].price.amountUsd:null}function u(e){return e.durationMinutes}function l(e){return function(r){var t=r.legs[e];return t&&t.departureTimeMinutes}}function p(e){return function(r){var t=r.legs[e];return t&&t.arrivalTimeMinutes+24*t.durationDays*60}}function f(e){return e.score}for(var d={PRICE:c,DURATION:u,SCORE:f},h=0;h<6;h++)d["LEG"+(h+1)+"_DEPARTURE_TIME"]=l(h),d["LEG"+(h+1)+"_ARRIVAL_TIME"]=p(h);var v=d[r.by]||function(){},y=o.cloneArray(e),g=!!i&&i.length>0,m=!!a&&a.length>0,C=!!s&&s.length>0;return(g||m||C)&&y.forEach((function(e){var r,t=[],o=[],c=n(e.fares);try{for(c.s();!(r=c.n()).done;){var u=r.value,l=!0,p=!0,f=!0;if(g){var d=i.includes("instant"),h=i.includes("airline");d&&h?l=u.provider.wegoFare||u.provider.instant||"airline"===u.provider.type:d?l=u.provider.wegoFare||u.provider.instant:h&&(l="airline"===u.provider.type)}if(m){var v=u.providerCode||u.provider.code;p=a.includes(v)}C&&s.includes("refundable")&&(f=u.refundable),l&&p&&f?t.push(u):o.push(u)}}catch(e){c.e(e)}finally{c.f()}e.fares=t.concat(o)})),y.sort((function(e,t){var n=o.compare(e,t,v,r.order);return 0==n&&"PRICE"!=r.by?o.compare(e,t,c,"ASC"):n})),y},getCheapestTrip:function(e,r){var t=!!r&&!!r.flexibilities&&r.flexibilities.length>0;return this._getBestTripBy(e,(function(e,n){if(!t)return e.fares[0].price.amountUsd<n.fares[0].price.amountUsd;if(r.flexibilities.includes("refundable")){var i=e.fares.find((function(e){return e.refundable})),o=n.fares.find((function(e){return e.refundable}));return i.price.amountUsd<o.price.amountUsd}}))},getFastestTrip:function(e){return this._getBestTripBy(e,(function(e,r){return e.durationMinutes===r.durationMinutes?e.fares[0].price.amountUsd<r.fares[0].price.amountUsd:e.durationMinutes<r.durationMinutes}))},getBestExperienceTrip:function(e){return this._getBestTripBy(e,(function(e,r){return e.score===r.score?e.fares[0].price.amountUsd<r.fares[0].price.amountUsd:e.score>r.score}))},_getBestTripBy:function(e,r){for(var t=e[0],n=1;n<e.length;n++)r(e[n],t)&&(t=e[n]);return t}}},55:(e,r,t)=>{function n(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function i(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?n(Object(t),!0).forEach((function(r){o(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):n(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function o(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function a(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var s=t(22),c=t(15),u=[0,300,600,900,2400,3800,5e3,6e3],l=function(){function e(r,t){!function(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}(this,e);var n=this;t=t||{},n.currency=t.currency||{},n.locale=t.locale,n.searchId=t.searchId,n.siteCode=t.siteCode,n.deviceType=t.deviceType||"DESKTOP",n.appType=t.appType||"WEB_APP",n.clientId=t.clientId,n.userLoggedIn=t.userLoggedIn,n.onProgressChanged=t.onProgressChanged||function(){},n.onHotelRatesChanged=t.onHotelRatesChanged||function(){},n.onSearchCreated=t.onSearchCreated||function(){},n.requestHeaders=t.requestHeaders,n.similarHotels=t.similarHotels||{},n.nearbyHotels=t.nearbyHotels||{},n.hotelDetailsEndpointUrl=r,n.extraSearchRequestBody=t.extraSearchRequestBody,n.bowOnly=t.bowOnly,n.poller=new c({delays:u,pollLimit:7,callApi:function(){var e={currencyCode:n.currency.code,locale:n.locale,clientId:n.clientId,amountType:"NIGHTLY"},r=n.trackingParams||{};for(var t in r)r.hasOwnProperty(t)&&(e[t]=r[t]);return n.similarHotels&&(e.similarHotelLimit=n.similarHotels.limit),n.nearbyHotels&&(e.nearbyHotelLimit=n.nearbyHotels.limit,e.nearbyHotelRadiusInKm=n.nearbyHotels.radiusInKm),n.searchId&&(e.searchId=n.searchId),s.fetchHotelRates(n.search.hotelId,e)},onSuccessResponse:function(e){return n.handleSearchResponse(e)}}),n.reset()}var r,t;return r=e,(t=[{key:"searchHotelRates",value:function(e,r){var t=this;if(t.search=e,t.searchId=void 0,void 0!==r)t.reset(),t.onProgressChanged(t.poller.getProgress()),t.searchId=r,t.poller.start();else{var n={currencyCode:t.currency.code,locale:t.locale,clientId:t.clientId,amountType:"NIGHTLY"};s.searchHotel(t.hotelDetailsEndpointUrl,t.getSearchRequestBody(),n,t.requestHeaders).then((function(e){t.reset(),t.onProgressChanged(t.poller.getProgress()),t.searchId=e.search.id,t.onSearchCreated(e.search),t.poller.start()}))}}},{key:"handleSearchResponse",value:function(e){var r=this;r.onProgressChanged(r.poller.getProgress()),r.onHotelRatesChanged(e)}},{key:"reset",value:function(){this.poller.reset()}},{key:"updateCurrency",value:function(e){this.currency=e}},{key:"getSearchRequestBody",value:function(){var e=this,r=e.search||{},t=(e.currency||{}).code,n=e.locale,o=e.extraSearchRequestBody||{},a=e.bowOnly,s=i({search:i(i({},o),{},{appType:e.appType,checkIn:r.checkIn,checkOut:r.checkOut,cityCode:r.cityCode,currencyCode:t,deviceType:e.deviceType,hotelId:r.hotelId,locale:n,rooms:r.rooms,siteCode:e.siteCode,userLoggedIn:e.userLoggedIn}),includeDirect:!0},!!a&&{bowOnly:a});return void 0!==e.searchId&&(s.search.id=e.searchId),null!=e.similarHotels&&(s.similarHotels=e.similarHotels),null!=e.nearbyHotels&&(s.nearbyHotels=e.nearbyHotels),s}}])&&a(r.prototype,t),e}();e.exports=l},376:(e,r,t)=>{function n(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function i(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?n(Object(t),!0).forEach((function(r){o(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):n(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function o(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function a(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var s=t(190),c=t(369),u=t(464),l=t(67),p=t(22),f=t(15),d=[0,300,600,900,2400,3800,5e3,6e3,6e3,6e3],h=function(){function e(r,t){!function(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}(this,e);var n=this;t=t||{},n.currency=t.currency||{},n.locale=t.locale,n.siteCode=t.siteCode,n.deviceType=t.deviceType||"DESKTOP",n.appType=t.appType||"WEB_APP",n.clientId=t.clientId,n.userLoggedIn=t.userLoggedIn,n.rateAmenityIds=t.rateAmenityIds||[],n.selectedHotelIds=t.selectedHotelIds||[],n.onProgressChanged=t.onProgressChanged||function(){},n.onHotelsChanged=t.onHotelsChanged||function(){},n.onTotalHotelsChanged=t.onTotalHotelsChanged||function(){},n.onDisplayedFilterChanged=t.onDisplayedFilterChanged||function(){},n.onProvidersChanged=t.onProvidersChanged||function(){},n.onSearchCreated=t.onSearchCreated||function(){},n.onDestinationInfoChanged=t.onDestinationInfoChanged||function(){},n.requestHeaders=t.requestHeaders,n.shortlistedHotelIds=t.shortlistedHotelIds||[],n.onGroupSearchChanged=t.onGroupSearchChanged||function(){},n.extraSearchRequestBody=t.extraSearchRequestBody,n.extraBodyParams=t.extraBodyParams,n.merger=new s,n.poller=new f({delays:d,pollLimit:d.length-1,initCallApi:function(){var e={currencyCode:n.currency.code,locale:n.locale,clientId:n.clientId,amountType:"NIGHTLY"};return p.searchHotels(r,n.getSearchRequestBody(),e,n.requestHeaders)},callApi:function(){return p.fetchHotels(r,n.responseSearch.id,n.fetchHotelsParams(),n.requestHeaders)},onSuccessResponse:function(e){return n.handleSearchResponse(e)}}),n.reset()}var r,t;return r=e,(t=[{key:"searchHotels",value:function(e){var r=this;r.search=e,r.reset(),r.updateResult(),r.poller.start()}},{key:"handleSearchResponse",value:function(e){var r=this;e.done&&r.poller.stop(),r.mergeResponse(e),r.updateResult(),1===r.poller.pollCount&&r.onSearchCreated(e.search),r.onGroupSearchChanged(e.groupSearch)}},{key:"mergeResponse",value:function(e){var r=this,t=e.done||r.poller.isLastPolling();r.merger.mergeResponse(e,t),r.lastRatesCount=e.count,r.responseSearch=e.search,l.prepareResponseSearch(r.responseSearch,r.merger.getStaticData())}},{key:"reset",value:function(){var e=this;e.poller.reset(),e.merger.reset(),e.responseSearch={},e.lastRatesCount=0}},{key:"updateSort",value:function(e){this.sort=e,this.updateResult()}},{key:"updateFilter",value:function(e){this.filter=e,this.updateResult()}},{key:"updateCurrency",value:function(e){var r=this;r.currency=e,r.merger.updateCurrency(e),r.updateResult()}},{key:"updateRateAmenityIds",value:function(e){var r=this;r.rateAmenityIds=e,r.reset(),r.poller.reset(),r.updateResult(),r.poller.start()}},{key:"updateResult",value:function(){var e=this,r=e.merger.getHotels(),t=u.filterHotels(r,e.filter),n=c.sortHotels(t,e.sort,e.filter);e.onHotelsChanged(n),e.onTotalHotelsChanged(r),e.onDisplayedFilterChanged(e.merger.getFilter()),e.onProgressChanged(e.poller.getProgress()),e.onDestinationInfoChanged(e.merger.getStaticData().destinationInfo),e.onProvidersChanged(e.merger.getProviders())}},{key:"getSearchRequestBody",value:function(){var e=this,r=e.search||{},t=(e.currency||{}).code,n=e.locale,o=e.extraSearchRequestBody||{},a=l.trimArray(e.selectedHotelIds),s=e.shortlistedHotelIds,c=e.extraBodyParams,u=i(i({search:i(i({},o),{},{appType:e.appType,checkIn:r.checkIn,checkOut:r.checkOut,cityCode:r.cityCode,countryCode:r.countryCode,currencyCode:t,deviceType:e.deviceType,districtId:r.districtId,hotelId:r.hotelId,id:e.responseSearch.id,locale:n,regionId:r.regionId,rooms:r.rooms,siteCode:e.siteCode,userLoggedIn:e.userLoggedIn}),includeDirect:!0},!!c&&c),{},{rateAmenityIds:e.rateAmenityIds,offset:e.lastRatesCount});return a.length&&Array.isArray(a)&&(u.selectedHotelIds=a),s.length&&Array.isArray(s)&&(u.shortlistedHotelIds=s),u}},{key:"fetchHotelsParams",value:function(){var e=this,r={currencyCode:e.currency.code,locale:e.locale,offset:e.lastRatesCount||0,amountType:"NIGHTLY",clientId:e.clientId,moreRates:!0},t=e.trackingParams||{};for(var n in t)t.hasOwnProperty(n)&&(r[n]=t[n]);var i=l.trimArray(e.selectedHotelIds);return i.length&&Array.isArray(i)&&(r.selectedHotelIds=i),e.poller.isLastPolling()&&(r.isLastPolling=!0),r.shortlistedHotelIds=e.shortlistedHotelIds,r}}])&&a(r.prototype,t),e}();e.exports=h},190:(e,r,t)=>{var n=t(853),i=t(67),o=function(e){e=e||{},this.currency=e.currency};o.prototype={reset:function(){this.__staticData=this._getEmptyStaticData(),this.__hotelMap={},this.__hotels=[],this.__filter=this._getEmptyFilter(),this.__filterOptionsMap=this._getEmptyFilterOptionsMap()},mergeResponse:function(e){var r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],t=this._getUpdatedHotelIds(e);this._mergeStaticData(e),this._mergeHotels(e.hotels),this._mergeFilter(Object.assign({},e.rentalFilter,e.filter),e.providers),this._mergeRates(e.rates,r),this._mergeSortedRatesByBasePrice(),this._mergeSortedRatesByTotalPrice(),this._mergeScores(e.scores),this._mergeRatesCounts(e.providerRatesCounts),this._cloneHotels(t)},getFilter:function(){return this.__filter},getProviders:function(){var e=this.__staticData.providers;return e?Object.keys(e).map((function(r){return e[r]})):[]},getHotels:function(){return this.__hotels},getStaticData:function(){return this.__staticData},updateCurrency:function(e){this.currency=e;var r=this.__hotelMap;for(var t in r)r[t].rates.forEach((function(r){r.price=i.convertPrice(r.price,e)}));this._cloneHotels(Object.keys(r));var o=this.__filter;o.minPrice=i.convertPrice(o.minPrice,e),o.maxPrice=i.convertPrice(o.maxPrice,e),this.__filter=n.cloneObject(this.__filter)},_mergeStaticData:function(e){var r=this.__staticData;this.__staticDataTypes.forEach((function(t){!function(e,r,t){if(r)if(Array.isArray(r))r.forEach((function(r){var n="providers"===t||"cities"===t?r.code:r.id;e[n]=r}));else for(var n in r)r.hasOwnProperty(n)&&(e[n]=r[n])}(r[t],e[t],t)}))},_mergeHotels:function(e){if(e){var r=this,t=this.__hotelMap;e.forEach((function(e){i.prepareHotel(e,r.__staticData),t[e.id]=t[e.id]||e}))}},_mergeRates:function(e,r){if(e){var t=this;e.forEach((function(e){i.prepareRate(e,t.currency,t.__staticData);var r=e.hotelId,n=t.__hotelMap[r];if(n){var o,a=n.rates;for(o=0;o<a.length&&!i.isBetterRate(e,a[o]);o++)if(e.providerCode===a[o].providerCode)return;for(a.splice(o,0,e),o++;o<a.length;o++)if(e.providerCode===a[o].providerCode){a.splice(o,1);break}}})),r&&this._lastMergeRates(e)}},_mergeSortedRatesByBasePrice:function(){var e=this,r=[];for(var t in e.__hotelMap)e.__hotelMap[t]&&(r=n.cloneArray(e.__hotelMap[t].rates).sort((function(e,r){var t=e.price.totalAmount,n=r.price.totalAmount,i=e.price.totalTaxAmount,o=r.price.totalTaxAmount;return t-i==n-o?r.price.ecpc-e.price.ecpc:t-i-(n-o)})),e.__hotelMap[t].sortedRatesByBasePrice=r)},_mergeSortedRatesByTotalPrice:function(){var e=this,r=[];for(var t in e.__hotelMap)e.__hotelMap[t]&&(r=n.cloneArray(e.__hotelMap[t].rates).sort((function(e,r){var t=e.price.totalAmount,n=r.price.totalAmount;return t===n?r.price.ecpc-e.price.ecpc:t-n})),e.__hotelMap[t].sortedRatesByTotalPrice=r)},_lastMergeRates:function(e){if(e){var r=this,t={};for(var n in r.__hotelMap)r.__hotelMap[n].rates&&1===r.__hotelMap[n].rates.length&&(t[n]=!0);var o={};for(var a in e){var s=e[a];if(t[s.hotelId]){o[s.hotelId]||(o[s.hotelId]=[]);var c,u=o[s.hotelId];for(c=0;c<u.length&&!i.isBetterRate(s,u[c]);c++);u.splice(c,0,s)}}for(var n in t){var l=r.__hotelMap[n].rates[0];(u=o[n])&&(u[0].id!==l.id&&u.splice(0,0,l),r.__hotelMap[n].rates=u)}}},_mergeScores:function(e){if(e){var r=this.__hotelMap;for(var t in e){var n=r[t];n&&(n.score=e[t])}}},_mergeRatesCounts:function(e){if(e){var r=this;e.forEach((function(e){var t=r.__hotelMap[e.hotelId];if(t){var n=e.providerCode,i=e.ratesCount,o=t.ratesCounts[n]||0;t.ratesCounts[n]=i,t.ratesCounts.total-=o,t.ratesCounts.total+=i}}))}},_mergeFilter:function(e,r){if(e){var t=this.__filter,o=this;e.minPrice&&(t.minPrice=i.convertPrice(e.minPrice,this.currency)),e.maxPrice&&(t.maxPrice=i.convertPrice(e.maxPrice,this.currency)),e.maxBedroomsCount&&(t.airbnbMaxBedroomCount=e.maxBedroomsCount),this.__filterOptionTypes.forEach((function(t){var n=e[t]||[];"providers"===t&&(n=r||[]),n.forEach((function(e){i.prepareFilterOption(e,t,o.__staticData),o.__filterOptionsMap[t][e.code]=e})),o._buildFilterOptions(t)})),this.__filter=n.cloneObject(this.__filter)}},_getEmptyStaticData:function(){var e={};return this.__staticDataTypes.forEach((function(r){e[r]={}})),e},_getEmptyFilterOptionsMap:function(){var e={};return this.__filterOptionTypes.forEach((function(r){e[r]={}})),e},_buildFilterOptions:function(e){this.__filter[e]=n.mapValues(this.__filterOptionsMap[e]).sort((function(e,r){return e.name<r.name?-1:e.name===r.name?0:1}))},_getEmptyFilter:function(){var e={};return this.__filterOptionTypes.forEach((function(r){e[r]=[]})),e},_getUpdatedHotelIds:function(e){var r={},t=this;if(e.rates&&e.rates.forEach((function(e){r[e.hotelId]=!0})),e.scores)for(var n in e.scores)r[n]=!0;return e.providerRatesCounts&&e.providerRatesCounts.forEach((function(e){r[e.hotelId]=!0})),Object.keys(r).filter((function(e){return t.__hotelMap[e]}))},_cloneHotels:function(e){var r=this.__hotelMap;e.forEach((function(e){var t=r[e];t?(t.rates=n.cloneArray(t.rates),t.ratesCounts=n.cloneObject(t.ratesCounts),r[e]=n.cloneObject(t)):console.error("Hotel with "+e+" is missing")})),this.__hotels=n.mapValues(r)},__staticDataTypes:["stars","brands","propertyTypes","districts","cities","amenities","rateAmenities","chains","providers","roomTypeCategories","destinationInfo"],__filterOptionTypes:["stars","brands","propertyTypes","districts","cities","amenities","rateAmenities","chains","providers","reviewerGroups","roomTypeCategories"]},e.exports=o},67:(e,r,t)=>{var n=t(853);e.exports={prepareResponseSearch:function(e,r){var t=e&&e.region;if(t){var n=[],i=r.cities;t.cityCodes.forEach((function(e){n.push(i[e])})),t.cities=n}},prepareHotel:function(e,r){e.district=r.districts[e.districtId],e.city=r.cities[e.cityCode],e.reviewMap=function(e,r){if(!e)return{};var t={};return e.forEach((function(e){var r;t[(r=e,r.reviewerGroup)]=e})),t}(e.reviews),e.ratesCounts={total:0};var t={};if((e.amenityIds||[]).forEach((function(e){t[e]=!0})),e.amenityIdMap=t,e.rates=[],e.images=e.images||[],e.propertyType=r.propertyTypes[e.propertyTypeId],e.provider=r.propertyTypes[e.provider],e.badges&&39===e.propertyTypeId){var n=r.roomTypeCategories[e.roomTypeCategoryId];n&&e.badges.push({text:n.name})}},prepareRate:function(e,r,t){e.provider=t.providers[e.providerCode],e.price=this.convertPrice(e.price,r)},convertPrice:function(e,r){if(!r)return e;if(!e)return null;var t=e.amount,i=e.totalAmount,o=e.taxAmount,a=e.totalTaxAmount;if(e.currencyCode!=r.code){var s=r.rate;i=(t=Math.round(e.amountUsd*s))*Math.round(e.totalAmountUsd/e.amountUsd),a=(o=Math.round(e.taxAmountUsd*s))*Math.round(e.totalTaxAmountUsd/e.taxAmountUsd)}var c=n.cloneObject(e);return c.currency=r,c.amount=t,c.totalAmount=i,c.taxAmount=o,c.totalTaxAmount=a,c},prepareFilterOption:function(e,r,t){var n=(t[this.__filterOptionTypeToStaticDataType[r]]||{})[e.code]||{};e.name=n.name},trimArray:function(e){if(e)return Array.isArray(e)&&(e=e.filter((function(e){return!!e&&""!=e.trim()}))),e},isBetterRate:function(e,r){function t(e){var r=Math.round(e.price.amount);return r>99999&&(r=r/100*100),r}function n(e){return e.price.taxAmountUsd<0?-1:1}var i=n(e),o=n(r);if(i!=o)return i>o;var a=t(e),s=t(r);return a!=s?a<s:!(!e.provider.directBooking||r.provider.directBooking)||!(r.provider.directBooking&&!e.provider.directBooking)&&("DIRECT_PRIORITY"==e.provider.type&&"DIRECT_PRIORITY"!=r.provider.type||("DIRECT_PRIORITY"!=r.provider.type||"DIRECT_PRIORITY"==e.provider.type)&&e.price.ecpc>r.price.ecpc)},__filterOptionTypeToStaticDataType:{stars:"stars",brands:"brands",propertyTypes:"propertyTypes",districts:"districts",cities:"cities",amenities:"amenities",rateAmenities:"rateAmenities",chains:"chains",providers:"providers",reviewerGroups:"reviewerGroups",roomTypeCategories:"roomTypeCategories"}}},464:(e,r,t)=>{var n=t(853);e.exports={filterHotels:function(e,r){if(!r)return e;var t=n.arrayToMap(r.stars),i=n.arrayToMap(r.districtIds),o=n.arrayToMap(r.cityCodes),a=n.arrayToMap(r.propertyTypeIds),s=n.arrayToMap(r.airbnbTypes),c=n.arrayToMap(r.brandIds),u=n.arrayToMap(r.chainIds);return e.filter((function(e){var l=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=r.providers,i=void 0===t?[]:t,o=r.providerCodes,a=void 0===o?[]:o,s=r.priceRange;if(!s)return!0;var c=e.rates||[];return i.length>0&&(c=c.filter((function(e){var r=-1!==i.indexOf("wego")&&e.provider.directBooking,t=-1!==i.indexOf("hotels")&&e.provider.isHotelWebsite,n=-1!==i.indexOf("ota")&&"OTA"===e.provider.type;return r||t||n}))),a.length>0&&(c=c.filter((function(e){return a.includes(e.providerCode)}))),c.length>0&&n.filterByRange(c[0].price.amountUsd,s)}(e,r)&&n.filterByKey(e.star,t)&&n.filterByContainAllKeys(e.amenityIdMap,r.amenityIds)&&n.filterByKey(e.districtId,i)&&n.filterByKey(e.cityCode,o)&&n.filterByKey(e.propertyTypeId,a)&&n.filterByKey(e.brandId,c)&&function(e,r){if(!r)return!0;if(n.filterByTextMatching(e.name,r))return!0;if(!e.nameI18n)return!1;for(var t in e.nameI18n)if(n.filterByTextMatching(e.nameI18n[t],r))return!0;return!1}(e,r.name)&&n.filterByKey(e.chainId,u)&&function(e,r){if(!r||0===r.length)return!0;for(var t=0;t<r.length;t++){var n=e.reviewMap[r[t]];if(n&&n.score>=80&&n.count>=100)return!0}return!1}(e,r.reviewerGroups)&&function(e,r){if(!r||0===r.length)return!0;var t=e.rates;if(!t)return!1;for(var n=0;n<t.length;n++)for(var i=0;i<r.length;i++)if(t[n].rateAmenityIds.includes(parseInt(r[i])))return!0;return!1}(e,r.rateAmenityIds)&&function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return 0===r.length||(e.rates||[]).some((function(e){return r.includes(e.providerCode)}))}(e,r.providerCodes)&&function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return 0===r.length||(e.rates||[]).some((function(e){var t=-1!==r.indexOf("wego")&&e.provider.directBooking,n=-1!==r.indexOf("hotels")&&e.provider.isHotelWebsite,i=-1!==r.indexOf("ota")&&"OTA"===e.provider.type;return t||n||i}))}(e,r.providers)&&function(e,r){if(!r||0===r.length)return!0;var t=e.rates;if(!t)return!1;for(var n=0;n<t.length;n++){var i=t[n];if(void 0!==i.usualPrice||i.promos&&i.promos.length>0)return!0}return!1}(e,r.deals)&&function(e,r){if(!r)return!0;var t=e.reviewMap.ALL||{};return n.filterByRange(t.score,r)}(e,r.reviewScoreRange);return 39===e.propertyTypeId?l&&function(e,r){return!(r>0)||e.bedroomsCount>=r}(e,r.airbnbBedroomCount?r.airbnbBedroomCount:0)&&n.filterByKey(e.roomTypeCategoryId,s):l}))}}},369:(e,r,t)=>{function n(e,r){var t="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=function(e,r){if(e){if("string"==typeof e)return i(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?i(e,r):void 0}}(e))||r&&e&&"number"==typeof e.length){t&&(e=t);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,c=!1;return{s:function(){t=t.call(e)},n:function(){var e=t.next();return s=e.done,e},e:function(e){c=!0,a=e},f:function(){try{s||null==t.return||t.return()}finally{if(c)throw a}}}}function i(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}var o=t(853);e.exports={sortHotels:function(e,r){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!r)return e;var i=t.providers,a=void 0===i?[]:i,s=t.providerCodes,c=void 0===s?[]:s;function u(e){return e.rates&&e.rates.length>0?e.rates[0].price.amountUsd:null}function l(e){return f(e)&&d(e.rates[0].usualPrice)?Math.round(100*e.rates[0].usualPrice.discountToUsualAmount):null}function p(e){var r;return f(e)&&d(e.rates[0].usualPrice)?(r=e.rates[0].usualPrice,Math.round(r.usualAmountUsd*r.discountToUsualAmount)):null}function f(e){return e.rates&&e.rates.length>0}function d(e){return void 0!==e}function h(e){return function(r){var t=r.reviewMap[e];return t?t.score:null}}function v(e){return 0===e.star?void 0:e.star}function y(e){return e.score}function g(e){return e.distanceToCityCentre}function m(e){return e.distanceToNearestAirport}var C={PRICE:u,DISCOUNT:l,SAVINGS:p,ALL_REVIEW_SCORE:h("ALL"),FAMILY_REVIEW_SCORE:h("FAMILY"),BUSINESS_REVIEW_SCORE:h("BUSINESS"),COUPLE_REVIEW_SCORE:h("COUPLE"),SOLO_REVIEW_SCORE:h("SOLO"),STAR:v,SCORE:y,DISTANCE_TO_CITY_CENTER:g,DISTANCE_TO_NEAREST_AIRPORT:m},_=C[r.by]||function(){},T=o.cloneArray(e);if(a.length>0||c.length>0){var A,I=n(T);try{for(I.s();!(A=I.n()).done;){var O,b=A.value,S=function(e){var r=-1!==a.indexOf("wego")&&e.provider.directBooking,t=-1!==a.indexOf("hotels")&&e.provider.isHotelWebsite,n=-1!==a.indexOf("ota")&&"OTA"===e.provider.type;return r||t||n},P=function(e){return!!e.providerCode&&-1!==c.indexOf(e.providerCode)},M=[],E=[],R=n(b.rates);try{for(R.s();!(O=R.n()).done;){var w=O.value;S(w)||P(w)?M.push(w):E.push(w)}}catch(e){R.e(e)}finally{R.f()}b.rates=M.concat(E)}}catch(e){I.e(e)}finally{I.f()}}return T.sort((function(e,t){var n=o.compare(e,t,_,r.order);return 0==n&&"PRICE"!=r.by?o.compare(e,t,u,"ASC"):n})),T}}},579:(e,r,t)=>{var n=t(22),i=t(469),o=t(376),a=t(55);e.exports={Api:n,FlightSearchClient:i,HotelSearchClient:o,HotelDetailsClient:a}},853:e=>{var r={cloneObject:function(e){var r={};for(var t in e)r[t]=e[t];return r},cloneArray:function(e){var r=[];return e.forEach((function(e){r.push(e)})),r},mapValues:function(e){return Object.keys(e).map((function(r){return e[r]}))},compare:function(e,r,t,n){var i=t(e),o=t(r);return i===o?0:null==i?1:null==o?-1:i>o==("ASC"===n)?1:-1},filterByKey:function(e,r){return!r||r[e]},filterByAllKeys:function(e,r){if(!r)return!0;if(0===e.length)return!1;for(var t=0;t<e.length;t++)if(!r[e[t]])return!1;return!0},filterBySomeKeys:function(e,r){if(!r||0===r.length)return!0;for(var t=0;t<r.length;t++)if(e[r[t]])return!0;return!1},filterByContainAllKeys:function(e,r){if(!r)return!0;for(var t=0;t<r.length;t++)if(!e[r[t]])return!1;return!0},filterByTextMatching:function(e,r){return!r||this.stripAccents(e).toLowerCase().indexOf(this.stripAccents(r).toLowerCase())>-1},filterByRange:function(e,r){if(!r)return!0;var t,n=r.min===t?0:r.min,i=r.max===t?1<<30:r.max;return n<=e&&e<=i},arrayToMap:function(e){if(!e||0===e.length)return null;var r={};return e.forEach((function(e){r[e]=!0})),r},arrayToMaps:function(e,r){if(!r)return this.arrayToMap(e);if(!e||0===e.length)return null;var t={};return e.forEach((function(e){var r=e[0]-1,n=e.substr(2);t[r]=t[r]||{},t[r][n]=!0})),t},stripAccents:function(){var e="àáâãäçèéêëìíîïñòóôõöùúûüýÿÀÁÂÃÄÇÈÉÊËÌÍÎÏÑÒÓÔÕÖÙÚÛÜÝ",r=new RegExp("["+e+"]","g"),t={};function n(e){return t[e]||e}for(var i=0;i<e.length;i++)t[e[i]]="aaaaaceeeeiiiinooooouuuuyyAAAAACEEEEIIIINOOOOOUUUUY"[i];return function(e){return e?e.replace(r,n):""}}()};e.exports=r}},r={},function t(n){var i=r[n];if(void 0!==i)return i.exports;var o=r[n]={exports:{}};return e[n](o,o.exports,t),o.exports}(579);var e,r}));